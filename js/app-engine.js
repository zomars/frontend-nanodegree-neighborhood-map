function initialize(){var a=new google.maps.LatLng(33.7406398,-116.4342134),b={zoom:13,center:a,disableDefaultUI:!0};map=new google.maps.Map(document.getElementById("map-canvas"),b)}function addGoogleMapsMarkers(a){function b(a){var b='<div class="info_content">';b+="<h4>"+a.title+"</h4>",b+="<p><strong>Phone</strong>: "+a.ph+"</p>",b+="<p><strong>Latest review:</strong></p>",b+='<p class="review"><img src="'+a.pic+'">'+a.blurb+"</p>",b+="</div>",g.setContent(String(b)),g.open(map,a)}function c(){for(var a=0,b=allMarkers.length;b>a;a++)allMarkers[a].setMap(null);allMarkers=[]}function d(a,c){return function(){b(a)}}function e(a,c){return function(){b(a),f(a,c)}}function f(a,b){var c=$(".js-sidebar").find("ul"),d=c.find("li"),e=212*b,f=d.eq(b);if(null!==a.getAnimation())a.setAnimation(null),c.removeClass("show"),f.removeClass("active");else{for(var g in allMarkers){var h=allMarkers[g].getAnimation();h&&g!==b&&allMarkers[g].setAnimation(null)}a.setAnimation(google.maps.Animation.BOUNCE),c.addClass("show").animate({scrollTop:e},300),c.find(".active").removeClass("active"),f.addClass("active")}}var g=new google.maps.InfoWindow;allMarkers.length>0&&c();for(var h=0,i=a.length;i>h;h++){var j=new google.maps.LatLng(a[h][2],a[h][3]),k=new google.maps.Marker({position:j,map:map,animation:google.maps.Animation.DROP,title:a[h][0],ph:a[h][1],pic:a[h][4],blurb:a[h][5]});allMarkers.push(k),google.maps.event.addListener(k,"mouseover",d(k,h)),google.maps.event.addListener(k,"click",e(k,h))}$(".js-search-results").find("li").click(function(){var a=$(this).index();for(var c in allMarkers){var d=allMarkers[c].getAnimation();d&&c!==a&&allMarkers[c].setAnimation(null)}allMarkers[a].setAnimation(google.maps.Animation.BOUNCE),b(allMarkers[a]),$(".js-search-results").find(".active").removeClass("active"),$(this).addClass("active")})}function makeYelpList(a){var b=$(".js-search-results"),c=a.businesses,d="";b.empty();var e=[];if(c.length>0){for(var f in c){var g=c[f],h=g.name,i=g.image_url,j=/^\+1/.test(g.display_phone)?g.display_phone:"",k=g.url,l=g.rating_img_url_small,m=(g.rating,{lat:g.location.coordinate.latitude,lon:g.location.coordinate.longitude,address:g.location.display_address[0]+"<br>"+g.location.display_address[g.location.display_address.length-1]}),n={img:g.snippet_image_url,txt:g.snippet_text},o='<li><div class="heading row"><p class="col-sm-3 img-container">';o+='<img src="'+i+'" height=100 width=100 class="img-thumbnail">',o+='<img src="'+l+'" height=17 width=84 alt="Yelp Rating">',o+='</p><div class="col-sm-9">',o+="<h3>"+h+"</h3><p>",o+="<span>"+m.address+"</span></p>",o+="<p><strong>"+j+"</strong></p>",o+='<p><a class="btn btn-default btn-small" href="'+k+'" target="_blank">Yelp it!</a></p>',o+="</div></div></li>",d+=o;var p=[h,j,m.lat,m.lon,n.img,n.txt];e.push(p)}b.append(d),google.maps.event.addDomListener(window,"load",addGoogleMapsMarkers(e))}else{var q=$("input").val();b.addClass("open").append("<li><h3>Oh no! We can't seem to find anything on <span>"+q+"</span>.</h3><p>Trying searching something else.</p></li>"),google.maps.event.addDomListener(window,"load",addGoogleMapsMarkers(e))}}function ajaxYelp(a,b){$.ajax({url:a,data:b,dataType:"jsonp",global:!0,jsonpCallback:"cb",success:function(a){makeYelpList(a)}})}function getYelpData(a,b){var c={consumerKey:"W-V8s-7Sp5pgZ2hPFhlU1Q",consumerSecret:"yGk31zr5RQGS2PM6ssoq9pgcKIQ",accessToken:"Pk3XNA5QnyOZRJiofxz-sWIotL8JIVKk",accessTokenSecret:"9Mlc5lMgRn-ua5gIFz8K28I4NlE",serviceProvider:{signatureMethod:"HMAC-SHA1"}},d={consumerSecret:c.consumerSecret,tokenSecret:c.accessTokenSecret},e=[];e.push(["term",b]),e.push(["location",a]),e.push(["callback","cb"]),e.push(["oauth_consumer_key",c.consumerKey]),e.push(["oauth_consumer_secret",c.consumerSecret]),e.push(["oauth_token",c.accessToken]),e.push(["oauth_signature_method","HMAC-SHA1"]);var f={action:"http://api.yelp.com/v2/search",method:"GET",parameters:e};OAuth.setTimestampAndNonce(f),OAuth.SignatureMethod.sign(f,d);var g=OAuth.getParameterMap(f.parameters);ajaxYelp(f.action,g)}var map;allMarkers=[],initialize(),getYelpData("92260","Coffee");